<!DOCTYPE html>
<html>
<head>
  <title>Create a new poll</title>
  <meta charset="UTF-8">
  <link href="shared_style.css" rel="stylesheet">
  <script src="api.js"></script>

  <style>
    .container {
      align-items: center;
      justify-content: center;
      display: flex;
      flex-direction: column;
    }

    .elem {
      padding-top: 1em;
    }

    .centered {
      display: flex;
      justify-content: center;
    }

    #freeform_options {
      display: none;
    }

    #freeform_options label {
      padding-left: 20px;
      padding-right: 5px;
    }

    #freeform_options.visible {
      display: block;
    }
  </style>
</head>

<body>
<div class="container">
  <form name="myform">
    <div class="elem">
      <label for="name">Name of the poll</label>
      <input type="text" id="name" name="name">
    </div>
    <div class="elem">
      <input type="radio" id="yesno" name="poll_type" value="yesno">
      <label for="yesno">Yes / No</label><br>

      <input type="radio" id="ab" name="poll_type" value="ab">
      <label for="ab">A/ B</label><br>

      <input type="radio" id="abcd" name="poll_type" value="abcd">
      <label for="abcd">A / B / C / D</label><br>

      <input type="radio" id="freeform" name="poll_type" value="freeform">
      <label for="freeform">Own text</label>

      <div id="freeform_options">
        <div class="centered" style="padding-top: 1em">
          <button type="button" id="add_element_button">Add element</button>
        </div>
        <script>
          window.addEventListener('load', () => {
            let freeformOptions = document.getElementById("freeform_options")

            document.getElementById("add_element_button").onclick = addElement

            function addElement() {
              freeformOptions.prepend(document.createElement("br"))
              {
                let label = document.createElement("label")
                label.innerText = "Entry name"
                let input = document.createElement("input")
                input.type = "text"
                input.name = "entry_name[]"

                freeformOptions.prepend(input)
                freeformOptions.prepend(label)
              }
            }

            for (let i = 0; i < 2; i++) {
              addElement()
            }
          })
        </script>
      </div>
    </div>
  </form>
  <div class="elem">
    <button type="button" onclick="submitGarbage()" id="submit">Submit form</button>
  </div>
</div>

<script>
  Array.from(document.myform.poll_type).forEach(element => {
    element.addEventListener("change", function () {
      if (this.value === "freeform") {
        document.getElementById("freeform_options").classList.add("visible")
      } else {
        document.getElementById("freeform_options").classList.remove("visible")
      }
    })
  })

  function submitGarbage() {
    let name = document.myform.name.value()
    let entries = []
    switch (document.myform.poll_type) {
      case "yesno": {
        entries = [new PollEntry("Yes", )]
      }
    }
    createPoll(new PollRequest(name))
  }
</script>
</body>
</html>